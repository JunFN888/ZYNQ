
<!DOCTYPE html>

<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>《第十八章》AD9238 双通道波形显示实验 &#8212; ZYNQ MPSoC开发平台FPGA教程 1.0 文档</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/groundwork.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="《第十九章》ADDA 测试实验" href="adda.html" />
    <link rel="prev" title="《第十七章》AD7606 多通道波形显示实验" href="ad7606.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="adda.html" title="《第十九章》ADDA 测试实验"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="ad7606.html" title="《第十七章》AD7606 多通道波形显示实验"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ZYNQ MPSoC开发平台FPGA教程 1.0 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">《第十八章》AD9238 双通道波形显示实验</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <img alt="../_images/88.png" src="../_images/88.png" />
<section id="ad9238">
<h1>《第十八章》AD9238 双通道波形显示实验<a class="headerlink" href="#ad9238" title="此标题的永久链接">¶</a></h1>
<p><strong>实验Vivado工程为“ad9238_hdmi_test”。</strong></p>
<section id="id1">
<h2>18.1硬件介绍<a class="headerlink" href="#id1" title="此标题的永久链接">¶</a></h2>
<section id="ad">
<h3>18.1.1 两通道AD模块说明<a class="headerlink" href="#ad" title="此标题的永久链接">¶</a></h3>
<p>黑金高速AD模块AN9238为2路65MSPS, 12位的模拟信号转数字信号模块。模块的AD转换采用了ADI公司的AD9238芯片, AD9238芯片支持2路AD输入转换,所以1片AD9238芯片一共支持2路的AD输入转换。模拟信号输入支持单端模拟信号输入,输入电压范围为-5V~+5V,接口为SMA插座。</p>
<p>模块有一个标准2.54mm间距的40针的排母,用于连接FPGA开发板, AN9238模块实物照片如下:</p>
<img alt="../_images/image115.png" class="align-center" src="../_images/image115.png" />
<p>AN9238模块实物图</p>
<p><strong>参数说明</strong>
以下为AN9238 高速AD模块的详细参数:</p>
<ul class="simple">
<li><p>AD转换芯片:1片AD9238</p></li>
<li><p>AD转换通道:2路;</p></li>
<li><p>AD采样速率: 65MSPS;</p></li>
<li><p>AD采样数据位数: 12位;</p></li>
<li><p>数字接口电平标准:+3.3V的CMOS电平</p></li>
<li><p>AD模拟信号输入范围:-5V~+5V;</p></li>
<li><p>模拟信号输入接口:SMA接口;</p></li>
<li><p>测量精度:10mV左右;</p></li>
<li><p>工作温度:-40°~85°;</p></li>
</ul>
</section>
<section id="id2">
<h3>18.1.2 模块功能说明<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h3>
<p><strong>AN9238模块的原理设计框图如下:</strong></p>
<img alt="../_images/image213.png" class="align-center" src="../_images/image213.png" />
<p>关于AD9238的电路具体参考设计请参考AD9238的芯片手册。</p>
<ol class="arabic simple">
<li><p>单端输入及运放电路</p></li>
</ol>
<p>单端输入AD1和AD2通过J5或者J6两个SMA头输入,单端输入的电压为-5V~+5V。</p>
<p>板上通过运放AD8065芯片和分压电阻把-5V~+5V输入的电压缩小成-1V~+1V。如果用户想输入更宽范围的电压输入只要修改前端的分压电阻的阻值。</p>
<img alt="../_images/image37.png" class="align-center" src="../_images/image37.png" />
<p>下表为模拟输入信号和AD8065运放输出后的电压对照表:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>AD模拟输入值</p></th>
<th class="head"><p>AD8065运放输出</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>-5V</p></td>
<td><p>-1V</p></td>
</tr>
<tr class="row-odd"><td><p>0V</p></td>
<td><p>0V</p></td>
</tr>
<tr class="row-even"><td><p>+5V</p></td>
<td><p>+1V</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li><p>单端转差分及AD转换</p></li>
</ol>
<p>-1V~+1V的输入电压通过AD8138芯片转换成差分信号(VIN+ − VIN−), 差分信号的共模电平由AD的CML管脚决定。</p>
<img alt="../_images/image44.png" class="align-center" src="../_images/image44.png" />
<p>下表为模拟输入信号到AD8138差分输出后的电压对照表:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>AD模拟输入值</p></th>
<th class="head"><p>AD8065运放输出</p></th>
<th class="head"><p>AD8138差分输出(VIN+−VIN−)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>-5V</p></td>
<td><p>-1V</p></td>
<td><p>-1V</p></td>
</tr>
<tr class="row-odd"><td><p>0V</p></td>
<td><p>0V</p></td>
<td><p>0V</p></td>
</tr>
<tr class="row-even"><td><p>+5V</p></td>
<td><p>+1V</p></td>
<td><p>+1V</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li><p>AD9238转换</p></li>
</ol>
<p>默认AD是配置成offset binary的,AD转换的值如下图所示:</p>
<img alt="../_images/image54.png" class="align-center" src="../_images/image54.png" />
<p>在模块电路设计中,AD9238的VREF的值为1V,这样最终的模拟信号输入和AD转换的数据如下:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>AD模拟输入值</p></th>
<th class="head"><p>AD8055运放输出</p></th>
<th class="head"><p>AD8138差分输出(VIN+−VIN−)</p></th>
<th class="head"><p>AD9238数字输出</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>-5V</p></td>
<td><p>-1V</p></td>
<td><p>-1V</p></td>
<td><p>000000000000</p></td>
</tr>
<tr class="row-odd"><td><p>0V</p></td>
<td><p>0V</p></td>
<td><p>0V</p></td>
<td><p>100000000000</p></td>
</tr>
<tr class="row-even"><td><p>+5V</p></td>
<td><p>+1V</p></td>
<td><p>+1V</p></td>
<td><p>11111111111</p></td>
</tr>
</tbody>
</table>
<p>从表中我们可以看出,-5V输入的时候,AD9238转换的数字值最小,+5V输入的时候,AD9238转换的数字值最大。</p>
<ol class="arabic simple">
<li><p>AD9238数字输出时序</p></li>
</ol>
<p>AD9238双通道AD的数字输出为+3.3V的CMOS输出模式,2路通道(A和B)独立的数据和时钟。AD数据在时钟的上降沿转换数据,FPGA端可用AD时钟的采样AD数据。</p>
<img alt="../_images/image64.png" class="align-center" src="../_images/image64.png" />
</section>
</section>
<section id="id3">
<h2>18.2程序设计<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h2>
<p>本实验显示部分是基于前面的HDMI显示彩条的实验,在彩条上叠加网格线和波形, 整个项目的框图如下图所示:</p>
<img alt="../_images/image74.png" class="align-center" src="../_images/image74.png" />
<p>ad9238_sample模块主要完成AN9238的单路数据转换。最后的数据只取高8位的数据,数据宽度转换到8bit(为了跟其它8位的AD模块程序兼容)。另外每次采集1280个数据,然后等待一段时间再继续采集下面的1280个数据。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>信号名称</p></th>
<th class="head"><p>方向</p></th>
<th class="head"><p>宽度(bit)</p></th>
<th class="head"><p>说明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>adc_clk</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>adc系统时钟</p></td>
</tr>
<tr class="row-odd"><td><p>rst</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>异步复位,高复位</p></td>
</tr>
<tr class="row-even"><td><p>adc_data</p></td>
<td><p>in</p></td>
<td><p>12</p></td>
<td><p>ADC数据输入</p></td>
</tr>
<tr class="row-odd"><td><p>adc_buf_wr</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>ADC数据写使能</p></td>
</tr>
<tr class="row-even"><td><p>adc_buf_addr</p></td>
<td><p>out</p></td>
<td><p>12</p></td>
<td><p>ADC数据写地址</p></td>
</tr>
<tr class="row-odd"><td><p>adc_buf_data</p></td>
<td><p>out</p></td>
<td><p>8</p></td>
<td><p>无符号8位ADC数据</p></td>
</tr>
</tbody>
</table>
<p>ad7606_sample模块端口</p>
<p>grid_display模块主要完成视频图像的网格线叠加,本实验将彩条视频输入,然后叠加一个网格后输出, 这一块网格区域提供给后面的波形显示模块使用,这个网格区域是位于显示器水平方向(从左到右)从9到1018,垂直方向(从上到下)从9到308的视频显示位置。</p>
<img alt="../_images/image83.png" class="align-center" src="../_images/image83.png" />
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>信号名称</p></th>
<th class="head"><p>方向</p></th>
<th class="head"><p>宽度(bit)</p></th>
<th class="head"><p>说明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>pclk</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>像素时钟</p></td>
</tr>
<tr class="row-odd"><td><p>rst_n</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>异步复位,低电平复位</p></td>
</tr>
<tr class="row-even"><td><p>i_hs</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>视频行同步输入</p></td>
</tr>
<tr class="row-odd"><td><p>i_vs</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>视频场同步输入</p></td>
</tr>
<tr class="row-even"><td><p>i_de</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>视频数据有效输入</p></td>
</tr>
<tr class="row-odd"><td><p>i_data</p></td>
<td><p>in</p></td>
<td><p>24</p></td>
<td><p>视频数据输入</p></td>
</tr>
<tr class="row-even"><td><p>o_hs</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>带网格视频行同步输出</p></td>
</tr>
<tr class="row-odd"><td><p>o_vs</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>带网格视频场同步输出</p></td>
</tr>
<tr class="row-even"><td><p>o_de</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>带网格视频数据有效输出</p></td>
</tr>
<tr class="row-odd"><td><p>o_data</p></td>
<td><p>out</p></td>
<td><p>24</p></td>
<td><p>带网格视频数据输出</p></td>
</tr>
</tbody>
</table>
<p>grid_display模块端口</p>
<p>wav_display显示模块主要是完成波形数据的叠加显示,模块内含有一个双口ram,写端口是由ADC采集模块写入,读端口是显示模块。在网格显示区域有效的时候,每行显示都会读取RAM中存储的AD数据值,跟Y坐标比较来判断显示波形或者不显示。</p>
<img alt="../_images/image93.png" class="align-center" src="../_images/image93.png" />
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>信号名称</p></th>
<th class="head"><p>方向</p></th>
<th class="head"><p>宽度(bit)</p></th>
<th class="head"><p>说明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>pclk</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>像素时钟</p></td>
</tr>
<tr class="row-odd"><td><p>rst_n</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>异步复位,低电平复位</p></td>
</tr>
<tr class="row-even"><td><p>wave_color</p></td>
<td><p>in</p></td>
<td><p>24</p></td>
<td><p>波形颜色,rgb</p></td>
</tr>
<tr class="row-odd"><td><p>adc_clk</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>adc模块时钟</p></td>
</tr>
<tr class="row-even"><td><p>adc_buf_wr</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>adc数据写使能</p></td>
</tr>
<tr class="row-odd"><td><p>adc_buf_addr</p></td>
<td><p>in</p></td>
<td><p>12</p></td>
<td><p>adc数据写地址</p></td>
</tr>
<tr class="row-even"><td><p>adc_buf_data</p></td>
<td><p>in</p></td>
<td><p>8</p></td>
<td><p>adc数据,无符号数</p></td>
</tr>
<tr class="row-odd"><td><p>i_hs</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>视频行同步输入</p></td>
</tr>
<tr class="row-even"><td><p>i_vs</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>视频场同步输入</p></td>
</tr>
<tr class="row-odd"><td><p>i_de</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>视频数据有效输入</p></td>
</tr>
<tr class="row-even"><td><p>i_data</p></td>
<td><p>in</p></td>
<td><p>24</p></td>
<td><p>视频数据输入</p></td>
</tr>
<tr class="row-odd"><td><p>o_hs</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>带网格视频行同步输出</p></td>
</tr>
<tr class="row-even"><td><p>o_vs</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>带网格视频场同步输出</p></td>
</tr>
<tr class="row-odd"><td><p>o_de</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>带网格视频数据有效输出</p></td>
</tr>
<tr class="row-even"><td><p>o_data</p></td>
<td><p>out</p></td>
<td><p>24</p></td>
<td><p>带网格视频数据输出</p></td>
</tr>
</tbody>
</table>
<p>wav_display模块端口</p>
<p>RAM的配置如下:</p>
<img alt="../_images/image103.png" class="align-center" src="../_images/image103.png" />
<img alt="../_images/image116.png" class="align-center" src="../_images/image116.png" />
<img alt="../_images/image122.png" class="align-center" src="../_images/image122.png" />
<p>timing_gen_xy模块为其它模块的子模块,完成视频图像的坐标生成,x坐标,从左到右增大,y坐标从上到下增大。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>信号名称</p></th>
<th class="head"><p>方向</p></th>
<th class="head"><p>宽度(bit)</p></th>
<th class="head"><p>说明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>clk</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>系统时钟</p></td>
</tr>
<tr class="row-odd"><td><p>rst_n</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>异步复位,低电平复位</p></td>
</tr>
<tr class="row-even"><td><p>i_hs</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>视频行同步输入</p></td>
</tr>
<tr class="row-odd"><td><p>i_vs</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>视频场同步输入</p></td>
</tr>
<tr class="row-even"><td><p>i_de</p></td>
<td><p>in</p></td>
<td><p>1</p></td>
<td><p>视频数据有效输入</p></td>
</tr>
<tr class="row-odd"><td><p>i_data</p></td>
<td><p>in</p></td>
<td><p>24</p></td>
<td><p>视频数据输入</p></td>
</tr>
<tr class="row-even"><td><p>o_hs</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>视频行同步输出</p></td>
</tr>
<tr class="row-odd"><td><p>o_vs</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>视频场同步输出</p></td>
</tr>
<tr class="row-even"><td><p>o_de</p></td>
<td><p>out</p></td>
<td><p>1</p></td>
<td><p>视频数据有效输出</p></td>
</tr>
<tr class="row-odd"><td><p>o_data</p></td>
<td><p>out</p></td>
<td><p>24</p></td>
<td><p>视频数据输出</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>out</p></td>
<td><p>12</p></td>
<td><p>坐标x输出</p></td>
</tr>
<tr class="row-odd"><td><p>y</p></td>
<td><p>out</p></td>
<td><p>12</p></td>
<td><p>坐标y输出</p></td>
</tr>
</tbody>
</table>
<p>timing_gen_xy模块端口</p>
</section>
<section id="id4">
<h2>18.3实验现象<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h2>
<p>连接电路如下,调节信号发生器的频率和幅度,AN9238输入范围-5V-5V,为了便于观察波形数据,建议信号输入频率 200Khz 到 1Mhz。观察显示器输出,红色波形为 CH1 输入、蓝色为 CH2 输入、黄色网格最上面横线代表 5V,最下面横线代表-5V,中间横线代表 0V,每个竖线间隔是 10 个采样点。</p>
<img alt="../_images/image132.png" class="align-center" src="../_images/image132.png" />
<p>硬件连接图</p>
<img alt="../_images/image141.png" class="align-center" src="../_images/image141.png" />
<img alt="../_images/888.png" src="../_images/888.png" />
<p><em>ZYNQ MPSoC开发平台FPGA教程</em>    - <a class="reference external" href="http://www.alinx.com">Alinx官方网站</a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">《第十八章》AD9238 双通道波形显示实验</a><ul>
<li><a class="reference internal" href="#id1">18.1硬件介绍</a><ul>
<li><a class="reference internal" href="#ad">18.1.1 两通道AD模块说明</a></li>
<li><a class="reference internal" href="#id2">18.1.2 模块功能说明</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3">18.2程序设计</a></li>
<li><a class="reference internal" href="#id4">18.3实验现象</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="ad7606.html"
                          title="上一章">《第十七章》AD7606 多通道波形显示实验</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="adda.html"
                          title="下一章">《第十九章》ADDA 测试实验</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/src/ad9238_d.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="提交" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             >索引</a></li>
        <li class="right" >
          <a href="adda.html" title="《第十九章》ADDA 测试实验"
             >下一页</a> |</li>
        <li class="right" >
          <a href="ad7606.html" title="《第十七章》AD7606 多通道波形显示实验"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ZYNQ MPSoC开发平台FPGA教程 1.0 文档</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">《第十八章》AD9238 双通道波形显示实验</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2023, ALINX       http://www.alinx.com.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3创建。
    </div>
  </body>
</html>